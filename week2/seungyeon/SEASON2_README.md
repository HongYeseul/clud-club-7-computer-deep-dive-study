![image](https://github.com/user-attachments/assets/d83a25c8-50fe-41c9-a3d6-0e7d45e18d6d)

[Lecture 10: Caching](https://cs.brown.edu/courses/csci1310/2020/notes/l10.html)

- Cache
   - Hit: 블록이 캐시에 이미 있을 때
   - Miss: 메모리 접근해서 블록 불러와서 캐시에 적재한 후에 반환
   - Hit Rate를 높여야 함
 
- `arrayaccess.cc` 프로그램 예시
   - 1천만개의 정수 배열 생성
   - 순차적으로 배열 접근하며 합산하는 로직을 수행했을 때 전체 실행시간 측정
 
   - DRAM만 있을 경우, 접근시간 60ns
   - 캐시가 있는 경우, 처음만 60ns, 캐시에서 읽을 때는 4ns
 
- 참조지역성
    - 가까운 메모리 주소들이 연달아 접근되는 경향
    - 예를 들어 배열을 순차적으로 읽는 것
    - 시간적 지역성
        - 최근에 접근한 데이터를 다시 접근할 가능성
     
- 순차 접근 vs 무작위 접근
    - 순차 접근
        - 지역성 존재
        - Hit Rate 높음
        - 실행시간 빠름
    - 무작위 접근
        - 지역성 없음
        - Hit Rate 낮음
        - 실행시간 느림
     
- MESI 규칙
    - **멀티코어/멀티프로세서 시스템에서 캐시 일관성(Cache Coherency)**을 유지하기 위한 캐시 동기화 프로토콜
    - 캐시 블록이 가질 수 있는 4가지 상태를 따서 이름을 붙임
        - Modified, Exclusive, Shared, Invalid

| 상태                | 설명                                   | 다른 캐시와의 관계                      |
| ----------------- | ------------------------------------ | ------------------------------- |
| **M (Modified)**  | 이 캐시에서만 가지고 있고, 메모리와 **값이 다름** (수정됨) | 다른 캐시는 이 블록을 **가지고 있지 않음**      |
| **E (Exclusive)** | 이 캐시만 가지고 있고, **메모리와 동일**            | 다른 캐시는 이 블록을 **가지고 있지 않음**      |
| **S (Shared)**    | 여러 캐시가 동일한 블록을 가지고 있음, **메모리와 동일**   | 읽기만 가능                          |
| **I (Invalid)**   | 캐시 블록이 **무효화됨** (사용할 수 없음)           | 다른 캐시가 이 데이터를 가지고 있거나 수정했을 수 있음 |
