# 1장 프로그래밍 언어부터 프로그램 실행까지, 이렇게 진행된다

> 프로그래머가 코드를 작성할 때 어떤 일이 일어나는가?

# 1.1 여러분이 프로그래밍 언어를 발명한다면?

### 부제: 프로그래밍 언어에 대해서

처음에는 CPU가 알기 위한 0과 1의 조합으로 코드 작성하였다.

추후에 발전하여 기계어와 해당 특정 작업을 간단하게 대응시켜 기계어를 인간이 읽고 이해할 수 있는 단어와 대응 시킨 어셈블리어가 등장하였다.

아직 저수준 언어(Low-level language)에 머물러 있는 상황
그 저수준 언어에서 반복적인 규칙형태를 발견하였고 그 반복적인 형태를
CPU가 이해할 수 있게 추상화하는 방법을 고민하였고, 나온 것이 규칙을 인간이 사용하는 언어(문장)로 표현해보기 위해 if else, for while 등 고급 프로그래밍 언어가 등장하기 시작함


하지만 그 조건, 순환 안에 또다른 조건, 순환, 함수 호출 등이 발생할 수 있어서 끊임없는 자식-손자 관계가 발생 할 수 있었으나 

끝없이 중첩된 것을 수열처럼 재귀로 표현할 수 있다는 사실을 발견함



그렇다면 위와 같이 조건, 순환, 함수 호출, 재귀 등을 컴퓨터가 이해하도록 만드는 방법은?
-> 트리 구조로 표현이 가능해짐

(37쪽 구문 트리 사진)

이제 리프 노드를 기계 명령어로 번역하면 그 결과를 리프 노드의 부모 노드에 적용할 수 있게 되고 그것을 반복하면 전체 구문트리를 기계 명령어로 번역이 가능해짐

정리해서 고급 프로그래밍 언어를 사용해서 코드를 작성한 것을 CPU가 인식할 수 있는 기계 명령어로 번역하는 역할이 바로 컴파일러이다.
-> 하지만 컴파일러 역시 설명처럼 구문 트리를 기계 명령어로 직접 번역하진 않는다.


세상에 다양한 CPU가 존재하는데 각각의 CPU가 사용하는 고유한 언어가 다르다
Arm, x86 끼리의 플랫폼 끼리의 호환성 문제처럼 말이다.

하지만 직접 표준 명령어 집합을 정의해서 CPU의 기계 명령어 실행 과정을 모방하는 프로그램을 작성하여 사용하는, CPU마다 상응하는 시뮬레이션 프로그램을 만들면 코드가 서로 다른 플랫폼에서 실행 시킬 수 있습니다.

이 시뮬레이션 프로그램을 가상 머신(Virtual machine)이라는 이름을 붙였다.



# 1.2 컴파일러는 어떻게 작동하는 것일까?

### 컴파일러의 작동 원리에 대해서..

> 컴파일러 : 고수준 언어를 저수준 언어로 번역하는 프로그램

쉽게 생각해서 밑의 그림과 같이 고수준 언어로 구성된 소스 코드를 컴파일러라는 프로그램을 통해서 기계가 알아들을 수 있는 저수준 언어로 구성된 실행 파일로 "번역" 시켜준다.

(42쪽 1-16 그림)


**컴파일러가 하는 작업**
- 소스 코드를 돌아다니면서 모든 토큰을 찾아냄 - 어휘 분석(lexical analysis)
(43쪽 토큰 사진)

- 구문에 따라서 토큰을 처리하여 해석한 구조를 구문 트리로 표현 - 해석(parsing)
(45쪽 구문 트리)

- 구문 트리가 생성되고 이상이 없는지 확인 - 의미 분석(semantic analysis)

- 구문 트리를 탐색한 결과를 바탕으로 중간 코드(IR Code)를 생성

(46쪽 구문 트리를 중간 코드로 표현한 것)

- 중간 코드 생성이 완료되면 어셈블리어 코드로 변환

- 어셈블리어 코드를 CPU가 실행할 수 있는 기계 명령어로 변환


**링크(link), 링커(linker)**
컴파일 과정을 거쳐 생성된 대상 파일(object file / .o 확장자 파일)이 여러 개가 생성된다면 이 여러 개의 대상 파일을 하나의 실행 파일로 합쳐주는 무엇인가가 필요하다

이 때 대상 파일을 병합하는 작업 그 자체를 링크(link)라고 표현하며 이 링크를 담당하는 프로그램을 링커(linker)라고 한다.


# 1.3 링커의 말할 수 없는 비밀

> 링커 : 컴파일러가 생성한 대상 파일 여러 개를 하나로 묶어 하나의 최종 실행 파일을 생성합니다.

